<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>전체 유저 조회</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        .table {
            table-layout: fixed;
            width: 100%;
        }

        .table th, .table td {
            vertical-align: middle;
            word-wrap: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 50px;
            height: 50px;
        }

        .table th:nth-child(1), .table td:nth-child(1) {
            width: 5%;
        }

        .table th:nth-child(2), .table td:nth-child(2) {
            width: 15%;
        }

        .table th:nth-child(3), .table td:nth-child(3) {
            width: 20%;
        }

        .table th:nth-child(4), .table td:nth-child(4) {
            width: 10%;
        }

        .table th:nth-child(5), .table td:nth-child(5) {
            width: 15%;
        }

        .table th:nth-child(6), .table td:nth-child(6) {
            width: 15%;
        }

        .table th:nth-child(7), .table td:nth-child(7) {
            width: 15%;
        }

        .table th:nth-child(8), .table td:nth-child(8) {
            width: 20%;
        }

        .container {
            margin-top: 20px;
        }

        .clickable-row {
            cursor: pointer; /* 클릭 가능한 포인터 표시 */
        }

    </style>
    <script>
        // 클릭 이벤트로 페이지 이동 처리
        function goToMemberPage(memberId) {
            location.href = `/member/${memberId}`;
        }
    </script>
</head>
<body>
<!-- Header -->
<div th:replace="~{layouts/header :: header}"></div>

<div class="container mt-5">
    <h1 class="mb-4">전체 유저 조회</h1>

    <!-- 유저 목록 테이블 -->
    <table class="table table-hover">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">이름</th>
            <th scope="col">이메일</th>
            <th scope="col">권한</th>
            <th scope="col">개인 전화번호</th>
            <th scope="col">사무실 전화번호</th>
            <th scope="col">가입일자</th>
            <th scope="col">소속</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="member : ${members}" class="clickable-row"
            th:onclick="|goToMemberPage(${member.memberId})|">

            <th scope="row" th:text="${member.memberId}">1</th>

            <td th:text="${member.memberName}">이름</td>
            <td th:text="${member.email}">이메일</td>
            <td th:text="${member.role}">권한</td>
            <td th:text="${member.personPhone}">전화번호</td>
            <td th:text="${member.officePhone}">전화번호</td>
            <td th:text="${#temporals.format(member.createdAt, 'yyyy.MM.dd HH:mm:ss')}">가입일자</td>
            <td>
                <span th:if="${member.policeUnitId != null && policeUnits[member.policeUnitId] != null}"
                      th:text="${policeUnits[member.policeUnitId].policeUnitName + ' ' + policeUnits[member.policeUnitId].policeUnitTypeDescription}">
                </span>
                <span th:unless="${member.policeUnitId != null && policeUnits[member.policeUnitId] != null}">정보 없음</span>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- 페이징 -->
    <nav th:if="${members.totalPages > 1}" class="mt-4">
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${members.hasPrevious() ? '' : 'disabled'}">
                <a class="page-link" th:href="@{/members(page=${members.number - 1})}" aria-label="이전">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" th:each="pageNum : ${#numbers.sequence(0, members.totalPages - 1)}"
                th:classappend="${pageNum == members.number ? 'active' : ''}">
                <a class="page-link" th:href="@{/members(page=${pageNum})}" th:text="${pageNum + 1}">1</a>
            </li>
            <li class="page-item" th:classappend="${members.hasNext() ? '' : 'disabled'}">
                <a class="page-link" th:href="@{/members(page=${members.number + 1})}" aria-label="다음">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<!-- Footer -->
<div th:replace="~{layouts/footer :: footer}"></div>

</body>
</html>
